<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Price Imputation & Forecasting - Enhanced Documentation</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="docs-container">
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1>üìà Price Imputation & Forecasting</h1>
                <p>API Documentation</p>
            </div>
            <div class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Navigation</div>
                    <ul class="nav-links">
                        <li><a href="index.html">üè† Home</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Overview</div>
                    <ul class="nav-links">
                        <li><a href="#introduction" class="active">Introduction</a></li>
                        <li><a href="#installation">Installation</a></li>
                        <li><a href="#quick-start">Quick Start</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Core Components</div>
                    <ul class="nav-links">
                        <li><a href="#main-class">Main Class</a></li>
                        <li><a href="#pipelines">Pipelines</a></li>
                    </ul>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">API Reference</div>
                    <ul class="nav-links">
                        <li><a href="#api-data">Data Processing</a></li>
                        <li><a href="#api-imputation">Imputation Models</a></li>
                        <li><a href="#api-forecasting">Forecasting Models</a></li>
                        <li><a href="#api-evaluation">Evaluation</a></li>
                                            <li><a href="#api-visualization">Visualization</a></li>
</ul>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Advanced Topics</div>
                    <ul class="nav-links">
                        <li><a href="#best-practices">Best Practices</a></li>
                        <li><a href="#troubleshooting">Troubleshooting</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div class="content-header">
                <h1>Price Imputation & Forecasting</h1>
                <p>Comprehensive ML Package for Handling Missing Price Data and Predicting Future Prices</p>
            </div>

            <div class="content-body">
                <section id="introduction">
                    <h2>Introduction</h2>
                    <p>The <strong>Price Imputation and Forecasting</strong> package provides a production-ready solution for handling missing price data and predicting future pricing trends using advanced machine learning techniques.</p>
                    
                    <h3>Key Features</h3>
                    <ul>
                        <li><strong>Advanced Imputation Models:</strong> Bidirectional RNN/LSTM/GRU with dual-input architecture for handling missing prices</li>
                        <li><strong>Multiple Forecasting Algorithms:</strong> LSTM, GRU, and other time-series models for price prediction</li>
                        <li><strong>Dual-Input Architecture:</strong> Combines sequential price data with static store features</li>
                        <li><strong>Comprehensive Data Processing:</strong> Automatic missing value handling, feature engineering, and data scaling</li>
                        <li><strong>Evaluation Metrics:</strong> MAE, RMSE, and MAPE for model quality assessment</li>
                        <li><strong>Interactive Visualizations:</strong> Plotly-based plots with customizable styling</li>
                    </ul>

                    <h3>Workflow Order</h3>
                    <p>The package executes operations in the following sequence:</p>
                    <ol>
                        <li><strong>Data Loading & Preprocessing:</strong> Load and clean pricing data</li>
                        <li><strong>Feature Engineering:</strong> Create temporal features and static store attributes</li>
                        <li><strong>Data Scaling:</strong> Normalize features for consistent analysis</li>
                        <li><strong>Imputation (Step 1):</strong> Fill missing price values using bidirectional models</li>
                        <li><strong>Forecasting (Step 2):</strong> Predict future prices using imputed data</li>
                        <li><strong>Evaluation:</strong> Assess model quality with metrics</li>
                        <li><strong>Visualization:</strong> Generate interactive plots</li>
                    </ol>
                </section>

                <section id="installation">
                    <h2>Installation</h2>
                    <pre><code>pip install git+https://github.com/isrkan/Competitive_Price_Intelligence.git#subdirectory=ml_packages/price_imputation_and_forecasting</code></pre>
                </section>

                <section id="quick-start">
                    <h2>Quick Start</h2>
                    <pre><code>from price_imputation_and_forecasting import PriceImputationForecasting
from price_imputation_and_forecasting.imputation_train_pipeline import run_imputation_train_pipeline
from price_imputation_and_forecasting.forecasting_train_pipeline import run_forecasting_train_pipeline
from price_imputation_and_forecasting.prediction_pipeline import run_prediction_pipeline

# Initialize
pif = PriceImputationForecasting()
config = pif.get_config()

# Train imputation model
imputation_results = run_imputation_train_pipeline(
    config=config,
    data_directory_path='./data',
    category='rice'
)

# Train forecasting model
forecasting_results = run_forecasting_train_pipeline(
    config=config,
    data_directory_path='./data',
    category='rice'
)

# Make predictions
predictions = run_prediction_pipeline(
    config=config,
    data_directory_path='./data',
    category='rice',
    imputation_model_path='models/imputation_model.h5',
    forecasting_model_path='models/forecasting_model.h5'
)</code></pre>
                </section>

                <section id="main-class">
                    <h2>Main Class: PriceImputationForecasting</h2>
                    <h3><span class="function-name">__init__(custom_config_path=None)</span></h3>
                    <p>Initialize the Price Imputation and Forecasting system.</p>
                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>custom_config_path</td>
                                <td>str, optional</td>
                                <td>Path to custom YAML configuration file</td>
                                <td>Valid file path or None</td>
                            </tr>
                        </tbody>
                    </table>
                    <h4>Example:</h4>
                    <pre><code>pif = PriceImputationForecasting(custom_config_path='my_config.yaml')</code></pre>

                    <h3><span class="function-name">get_config()</span></h3>
                    <p>Retrieve the current configuration object.</p>
                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>Config</strong>: Configuration object containing all settings</li>
                    </ul>
                </section>

                <section id="pipelines">
                    <h2>Pipeline Modules</h2>
                    <p>The package provides three main pipelines for different stages of the ML workflow:</p>

                    <h3>1. Imputation Training Pipeline</h3>
                    <h4><span class="function-name">run_imputation_train_pipeline(...)</span></h4>
                    <p>Trains models to fill missing price values using bidirectional LSTM/GRU/RNN architectures.</p>
                    
                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>config</td>
                                <td>Config</td>
                                <td>Configuration object from PriceImputationForecasting</td>
                                <td>Valid Config object</td>
                            </tr>
                            <tr>
                                <td>data_directory_path</td>
                                <td>str</td>
                                <td>Root directory containing data files</td>
                                <td>Valid directory path</td>
                            </tr>
                            <tr>
                                <td>category</td>
                                <td>str</td>
                                <td>Product category name</td>
                                <td>e.g., 'rice', 'pasta'</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <p>Dictionary containing:</p>
                    <ul>
                        <li><strong>model</strong>: Trained imputation model</li>
                        <li><strong>history</strong>: Training history with loss values</li>
                        <li><strong>evaluation_metrics</strong>: MAE, RMSE, MAPE on validation set</li>
                        <li><strong>imputed_data</strong>: DataFrame with imputed prices</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.imputation_train_pipeline import run_imputation_train_pipeline

results = run_imputation_train_pipeline(
    config=config,
    data_directory_path='./data',
    category='rice'
)

print(f"Imputation MAE: {results['evaluation_metrics']['mae']:.3f}")
print(f"Imputation RMSE: {results['evaluation_metrics']['rmse']:.3f}")</code></pre>

                    <h3>2. Forecasting Training Pipeline</h3>
                    <h4><span class="function-name">run_forecasting_train_pipeline(...)</span></h4>
                    <p>Trains models to predict future prices using LSTM/GRU architectures on imputed data.</p>
                    
                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>config</td>
                                <td>Config</td>
                                <td>Configuration object from PriceImputationForecasting</td>
                                <td>Valid Config object</td>
                            </tr>
                            <tr>
                                <td>data_directory_path</td>
                                <td>str</td>
                                <td>Root directory containing data files</td>
                                <td>Valid directory path</td>
                            </tr>
                            <tr>
                                <td>category</td>
                                <td>str</td>
                                <td>Product category name</td>
                                <td>e.g., 'rice', 'pasta'</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h4>Returns:</h4>
                    <p>Dictionary containing:</p>
                    <ul>
                        <li><strong>model</strong>: Trained forecasting model</li>
                        <li><strong>history</strong>: Training history with loss values</li>
                        <li><strong>evaluation_metrics</strong>: MAE, RMSE, MAPE on test set</li>
                        <li><strong>forecasts</strong>: Array of predicted future prices</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.forecasting_train_pipeline import run_forecasting_train_pipeline

results = run_forecasting_train_pipeline(
    config=config,
    data_directory_path='./data',
    category='rice'
)

print(f"Forecasting MAE: {results['evaluation_metrics']['mae']:.3f}")
print(f"Forecasting RMSE: {results['evaluation_metrics']['rmse']:.3f}")</code></pre>

                    <h3>3. Prediction Pipeline</h3>
                    <h4><span class="function-name">run_prediction_pipeline(...)</span></h4>
                    <p>Uses trained models to impute missing values and generate price forecasts for new data.</p>
                    
                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>config</td>
                                <td>Config</td>
                                <td>Configuration object from PriceImputationForecasting</td>
                                <td>Valid Config object</td>
                            </tr>
                            <tr>
                                <td>data_directory_path</td>
                                <td>str</td>
                                <td>Root directory containing data files</td>
                                <td>Valid directory path</td>
                            </tr>
                            <tr>
                                <td>category</td>
                                <td>str</td>
                                <td>Product category name</td>
                                <td>e.g., 'rice', 'pasta'</td>
                            </tr>
                            <tr>
                                <td>imputation_model_path</td>
                                <td>str</td>
                                <td>Path to saved imputation model</td>
                                <td>Valid .h5 file path</td>
                            </tr>
                            <tr>
                                <td>forecasting_model_path</td>
                                <td>str</td>
                                <td>Path to saved forecasting model</td>
                                <td>Valid .h5 file path</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h4>Returns:</h4>
                    <p>Dictionary containing:</p>
                    <ul>
                        <li><strong>imputed_data</strong>: DataFrame with imputed prices</li>
                        <li><strong>forecasts</strong>: Array of predicted future prices</li>
                        <li><strong>forecast_dates</strong>: Dates corresponding to forecasts</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.prediction_pipeline import run_prediction_pipeline

predictions = run_prediction_pipeline(
    config=config,
    data_directory_path='./data',
    category='rice',
    imputation_model_path='models/imputation_model.h5',
    forecasting_model_path='models/forecasting_model.h5'
)

print(f"Imputed {len(predictions['imputed_data'])} price records")
print(f"Generated {len(predictions['forecasts'])} forecasts")</code></pre>

                    <div class="alert alert-info">
                        <strong>Pipeline Order:</strong> For training, always run the imputation training pipeline first, then the forecasting training pipeline. For predictions, the prediction pipeline handles both imputation and forecasting in sequence.
                    </div>
                </section>

                <section id="api-reference">
                    <h2>API Reference</h2>
                    <p>Comprehensive documentation for all modules and functions in the package.</p>
                </section>

                <section id="api-data">
                    <h2>Data Processing Module</h2>
                    
                    <h3>load_store_data</h3>
                    <p>Loads store metadata from CSV files and merges with sub-chain information.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def load_store_data(
    store_file_path: str,
    subchain_file_path: str
) -> pd.DataFrame</code></pre>

                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>store_file_path</td>
                                <td>str</td>
                                <td>Path to CSV file containing store data</td>
                                <td>Valid CSV file path</td>
                            </tr>
                            <tr>
                                <td>subchain_file_path</td>
                                <td>str</td>
                                <td>Path to Excel file containing subchain names</td>
                                <td>Valid Excel file path</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>store_data_df</strong> (pd.DataFrame): Merged DataFrame containing store information with subchain names</li>
                    </ul>

                    <h4>Examples:</h4>
                    <pre><code># Example 1: Load store data
store_data = load_store_data(
    'data/stores.csv',
    'data/subchains.xlsx'
)

print(f"Loaded {len(store_data)} stores")
print(store_data.head())</code></pre>

                    <h3>load_price_data</h3>
                    <p>Loads price data from Parquet files for a specific product category.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def load_price_data(
    category: str,
    price_data_dir: str
) -> pd.DataFrame</code></pre>

<h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>category</td>
                                <td>str</td>
                                <td>Product category name</td>
                                <td>e.g., 'rice', 'pasta', 'milk'</td>
                            </tr>
                            <tr>
                                <td>price_data_dir</td>
                                <td>str</td>
                                <td>Directory containing price data Parquet files</td>
                                <td>Valid directory path</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>price_data_df</strong> (pd.DataFrame): Price data with multi-index and date columns</li>
                    </ul>

                    <h4>Examples:</h4>
                    <pre><code># Example 1: Load price data
price_data = load_price_data(
    category='Electronics',
    price_data_dir='data/prices/'
)

print(f"Loaded price data with shape: {price_data.shape}")
print(price_data.head())</code></pre>

                    <h3>filter_missing_values_from_price_data</h3>
                    <p>Filters rows based on proportion of non-missing values.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def filter_missing_values_from_price_data(
    category_df: pd.DataFrame,
    threshold_ratio: float
) -> pd.DataFrame</code></pre>

                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>category_df</td>
                                <td>pd.DataFrame</td>
                                <td>Input price data DataFrame</td>
                                <td>Non-empty DataFrame</td>
                            </tr>
                            <tr>
                                <td>threshold_ratio</td>
                                <td>float</td>
                                <td>Minimum ratio of non-missing values (0-1)</td>
                                <td>0.0 to 1.0</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>filtered_df</strong> (pd.DataFrame): Filtered DataFrame with rows meeting threshold</li>
                    </ul>

                    <h4>Examples:</h4>
                    <pre><code># Example 1: Filter rows with too many missing values
filtered_data = filter_missing_values_from_price_data(
    price_data,
    threshold_ratio=0.7
)

print(f"Original rows: {len(price_data)}")
print(f"Filtered rows: {len(filtered_data)}")
print(f"Removed {len(price_data) - len(filtered_data)} rows")</code></pre>
                </section>

                <section id="api-imputation">
                    <h2>Imputation Models Module</h2>
                    
                    <h3>train_bi_lstm</h3>
                    <p>Trains a bidirectional LSTM model for price imputation using dual-input architecture.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def train_bi_lstm(
    X_sequence_train: np.ndarray,
    X_static_train: np.ndarray,
    target_mask_train: np.ndarray,
    y_train: np.ndarray,
    X_sequence_val: np.ndarray,
    X_static_val: np.ndarray,
    target_mask_val: np.ndarray,
    y_val: np.ndarray,
    **kwargs
) -> Tuple[Model, History]</code></pre>

                    <h4>Key Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>X_sequence_train</td>
                                <td>np.ndarray</td>
                                <td>Sequential training data (prices with gaps and observation masks)</td>
                                <td>Shape: (samples, sequence_length, 2)</td>
                            </tr>
                            <tr>
                                <td>X_static_train</td>
                                <td>np.ndarray</td>
                                <td>Static features (store metadata)</td>
                                <td>Shape: (samples, num_static_features)</td>
                            </tr>
                            <tr>
                                <td>target_mask_train</td>
                                <td>np.ndarray</td>
                                <td>Binary mask indicating positions to impute</td>
                                <td>Shape: (samples, sequence_length)</td>
                            </tr>
                            <tr>
                                <td>y_train</td>
                                <td>np.ndarray</td>
                                <td>Target values for training</td>
                                <td>Shape: (samples, sequence_length)</td>
                            </tr>
                            <tr>
                                <td>seq_units</td>
                                <td>int</td>
                                <td>Number of LSTM units</td>
                                <td>Default: 128, Range: 64-512</td>
                            </tr>
                            <tr>
                                <td>dropout_rate</td>
                                <td>float</td>
                                <td>Dropout rate for regularization</td>
                                <td>Default: 0.2, Range: 0.0-0.5</td>
                            </tr>
                            <tr>
                                <td>epochs</td>
                                <td>int</td>
                                <td>Number of training epochs</td>
                                <td>Default: 30, Range: 10-100</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>model</strong> (Model): Trained Keras model</li>
                        <li><strong>history</strong> (History): Training history object</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.imputation.bi_lstm import train_bi_lstm

model, history = train_bi_lstm(
    X_sequence_train, X_static_train, target_mask_train, y_train,
    X_sequence_val, X_static_val, target_mask_val, y_val,
    seq_units=128,
    dropout_rate=0.2,
    epochs=30
)</code></pre>

                    <h3>train_bi_gru</h3>
                    <p>Trains a bidirectional GRU model for price imputation.</p>
                    
                    <h4>Key Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>seq_units</td>
                                <td>int</td>
                                <td>Number of GRU units</td>
                                <td>Default: 128, Range: 64-512</td>
                            </tr>
                            <tr>
                                <td>dropout_rate</td>
                                <td>float</td>
                                <td>Dropout rate for regularization</td>
                                <td>Default: 0.2, Range: 0.0-0.5</td>
                            </tr>
                            <tr>
                                <td>epochs</td>
                                <td>int</td>
                                <td>Number of training epochs</td>
                                <td>Default: 30, Range: 10-100</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.imputation.bi_gru import train_bi_gru

model, history = train_bi_gru(
    X_sequence_train, X_static_train, target_mask_train, y_train,
    X_sequence_val, X_static_val, target_mask_val, y_val,
    seq_units=128,
    epochs=30
)</code></pre>
                </section>

                <section id="api-forecasting">
                    <h2>Forecasting Models Module</h2>
                    
                    <h3>train_lstm</h3>
                    <p>Trains an LSTM model for price forecasting.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def train_lstm(
    X_train: np.ndarray,
    y_train: np.ndarray,
    X_val: np.ndarray,
    y_val: np.ndarray,
    **kwargs
) -> Tuple[Model, History]</code></pre>

                    <h4>Key Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>X_train</td>
                                <td>np.ndarray</td>
                                <td>Training sequences</td>
                                <td>Shape: (samples, lookback, features)</td>
                            </tr>
                            <tr>
                                <td>y_train</td>
                                <td>np.ndarray</td>
                                <td>Target forecasts</td>
                                <td>Shape: (samples, horizon)</td>
                            </tr>
                            <tr>
                                <td>lstm_units</td>
                                <td>int</td>
                                <td>Number of LSTM units</td>
                                <td>Default: 128, Range: 64-512</td>
                            </tr>
                            <tr>
                                <td>dropout_rate</td>
                                <td>float</td>
                                <td>Dropout rate for regularization</td>
                                <td>Default: 0.2, Range: 0.0-0.5</td>
                            </tr>
                            <tr>
                                <td>epochs</td>
                                <td>int</td>
                                <td>Number of training epochs</td>
                                <td>Default: 30, Range: 10-100</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>model</strong> (Model): Trained Keras model</li>
                        <li><strong>history</strong> (History): Training history object</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.forecasting.lstm import train_lstm

model, history = train_lstm(
    X_train, y_train, X_val, y_val,
    lstm_units=256,
    epochs=50
)</code></pre>

                    <h3>train_gru</h3>
                    <p>Trains a GRU model for price forecasting.</p>
                    
                    <h4>Key Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>gru_units</td>
                                <td>int</td>
                                <td>Number of GRU units</td>
                                <td>Default: 128, Range: 64-512</td>
                            </tr>
                            <tr>
                                <td>dropout_rate</td>
                                <td>float</td>
                                <td>Dropout rate for regularization</td>
                                <td>Default: 0.2, Range: 0.0-0.5</td>
                            </tr>
                            <tr>
                                <td>epochs</td>
                                <td>int</td>
                                <td>Number of training epochs</td>
                                <td>Default: 30, Range: 10-100</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.forecasting.gru import train_gru

model, history = train_gru(
    X_train, y_train, X_val, y_val,
    gru_units=256,
    epochs=50
)</code></pre>
                </section>

                <section id="api-evaluation">
                    <h2>Evaluation Module</h2>
                    
                    <h3>evaluate_imputation</h3>
                    <p>Evaluates imputation model performance using multiple metrics.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def evaluate_imputation(
    y_true: np.ndarray,
    y_pred: np.ndarray,
    mask: np.ndarray
) -> Dict[str, float]</code></pre>

                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>y_true</td>
                                <td>np.ndarray</td>
                                <td>True values</td>
                                <td>Shape: (samples, sequence_length)</td>
                            </tr>
                            <tr>
                                <td>y_pred</td>
                                <td>np.ndarray</td>
                                <td>Predicted values</td>
                                <td>Shape: (samples, sequence_length)</td>
                            </tr>
                            <tr>
                                <td>mask</td>
                                <td>np.ndarray</td>
                                <td>Binary mask for evaluation positions</td>
                                <td>Shape: (samples, sequence_length)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>metrics</strong> (Dict[str, float]): Dictionary containing MAE, RMSE, MAPE</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.evaluation.evaluate_imputation import evaluate_imputation

metrics = evaluate_imputation(y_true, y_pred, mask)
print(f"MAE: {metrics['mae']:.3f}")
print(f"RMSE: {metrics['rmse']:.3f}")
print(f"MAPE: {metrics['mape']:.3f}")</code></pre>

                    <h3>evaluate_forecasting</h3>
                    <p>Evaluates forecasting model performance using multiple metrics.</p>
                    
                    <h4>Function Signature:</h4>
                    <pre><code>def evaluate_forecasting(
    y_true: np.ndarray,
    y_pred: np.ndarray
) -> Dict[str, float]</code></pre>

                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>y_true</td>
                                <td>np.ndarray</td>
                                <td>True forecast values</td>
                                <td>Shape: (samples, horizon)</td>
                            </tr>
                            <tr>
                                <td>y_pred</td>
                                <td>np.ndarray</td>
                                <td>Predicted forecast values</td>
                                <td>Shape: (samples, horizon)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>metrics</strong> (Dict[str, float]): Dictionary containing MAE, RMSE, MAPE</li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.evaluation.evaluate_forecasting import evaluate_forecasting

metrics = evaluate_forecasting(y_true, y_pred)
print(f"Forecasting MAE: {metrics['mae']:.3f}")
print(f"Forecasting RMSE: {metrics['rmse']:.3f}")</code></pre>
                </section>

                <section id="api-visualization">
                    <h2>Visualization Module</h2>
                    
                    <h3>visualize_imputation_forecasting_results</h3>
                    <p>Creates interactive plots showing both imputation and forecasting results in a comprehensive visualization. The function creates comprehensive time series plots for each row in the input data, displaying:</p>
                    <ul>
                        <li><strong>Forecasted Series:</strong> Future price predictions shown as red dashed line ("dot" style)</li>
                        <li><strong>Imputed Series:</strong> Historical prices with missing values filled, shown as blue solid line</li>
                        <li><strong>Original Series:</strong> Raw historical data with NaN values, shown as black circular markers</li>
                    </ul>

                    <h4>Function Signature:</h4>
                    <pre><code>def visualize_imputation_forecasting_results(
    df_price_input: pd.DataFrame,
    df_price_with_imputed_data: pd.DataFrame,
    df_price_with_forecasted_data: pd.DataFrame
) -> Dict[int, plotly.graph_objects.Figure]</code></pre>

                    <h4>Parameters:</h4>
                    <table class="parameter-table">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Valid Values</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>df_price_input</td>
                                <td>pd.DataFrame</td>
                                <td>Original price data with missing values (input data)</td>
                                <td>DataFrame with datetime index and price columns</td>
                            </tr>
                            <tr>
                                <td>df_price_with_imputed_data</td>
                                <td>pd.DataFrame</td>
                                <td>Price data after imputation (missing values filled)</td>
                                <td>DataFrame with datetime index and price columns</td>
                            </tr>
                            <tr>
                                <td>df_price_with_forecasted_data</td>
                                <td>pd.DataFrame</td>
                                <td>Price data with forecasted future values</td>
                                <td>DataFrame with datetime index and price columns</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Returns:</h4>
                    <ul>
                        <li><strong>figs</strong> (Dict[int, plotly.graph_objects.Figure]): Dictionary of interactive Plotly figures keyed by row index, showing:
                            <ul>
                                <li>Forecasted series (future predictions) in red dashed line</li>
                                <li>Imputed series (filled missing values) in blue solid line</li>
                                <li>Original series (raw historical data with NaNs) in black markers</li>
                            </ul>
                        </li>
                    </ul>

                    <h4>Example:</h4>
                    <pre><code>from price_imputation_and_forecasting.visualization.plot_predicted_time_series import visualize_imputation_forecasting_results
import pandas as pd

# Assume you have three DataFrames:
# - df_original: Original price data with missing values
# - df_imputed: Price data after imputation
# - df_forecasted: Price data with forecasted future values

figs = visualize_imputation_forecasting_results(
    df_price_input=df_original,
    df_price_with_imputed_data=df_imputed,
    df_price_with_forecasted_data=df_forecasted
)

# Display the first figure
figs[0].show()

# Or iterate through all figures
for idx, fig in figs.items():
    print(f"Displaying figure for row {idx}")
    fig.show()</code></pre>
                </section>

                <section id="best-practices">
                    <h2>Best Practices</h2>
                    
                    <h3>Data Quality</h3>
                    <ul>
                        <li>Ensure price data covers sufficient time periods (minimum 30 days recommended)</li>
                        <li>Handle missing values appropriately using the threshold_ratio parameter</li>
                        <li>Verify store metadata completeness before analysis</li>
                    </ul>

                    <h3>Model Selection</h3>
                    <ul>
                        <li><strong>Bidirectional LSTM:</strong> Best for imputation with temporal context</li>
                        <li><strong>LSTM:</strong> Best for forecasting with sequential patterns</li>
                        <li><strong>GRU:</strong> Faster alternative to LSTM with similar performance</li>
                    </ul>

                    <h3>Pipeline Order</h3>
                    <div class="alert alert-info">
                        <strong>Critical:</strong> Always perform imputation before forecasting. The forecasting models require complete data without missing values.
                    </div>
                    
                    <h3>Training Workflow</h3>
                    <ol>
                        <li>Train imputation model using <code>run_imputation_train_pipeline</code></li>
                        <li>Save the trained imputation model</li>
                        <li>Train forecasting model using <code>run_forecasting_train_pipeline</code></li>
                        <li>Save the trained forecasting model</li>
                        <li>Use both models in <code>run_prediction_pipeline</code> for production predictions</li>
                    </ol>
                </section>

                <section id="troubleshooting">
                    <h2>Troubleshooting</h2>
                    
                    <h3>Common Issues</h3>
                    
                    <h4>Issue: Poor imputation quality</h4>
                    <p><strong>Solution:</strong> Try adjusting model parameters or using more training data</p>
                    <pre><code>config.set('seq_units', 256)
config.set('epochs', 50)</code></pre>

                    <h4>Issue: Forecasts are inaccurate</h4>
                    <p><strong>Solution:</strong> Ensure imputation was successful and try different model architectures</p>
                    <pre><code>config.set('lstm_units', 256)
config.set('lookback', 60)</code></pre>
                    
                    <h4>Issue: Model training is too slow</h4>
                    <p><strong>Solution:</strong> Reduce model complexity or use GPU acceleration</p>
                    <pre><code>config.set('seq_units', 64)
config.set('batch_size', 64)</code></pre>
                </section>

    </body>
</html>
                

                <section id="best-practices">
                    <h2>Best Practices</h2>
                    
                    <h3>Data Quality</h3>
                    <ul>
                        <li>Ensure price data covers sufficient time periods (minimum 30 days recommended)</li>
                        <li>Handle missing values appropriately using the threshold_ratio parameter</li>
                        <li>Verify store metadata completeness before analysis</li>
                    </ul>

                    <h3>Model Selection</h3>
                    <ul>
                        <li><strong>Bidirectional LSTM:</strong> Best for imputation with temporal context</li>
                        <li><strong>LSTM:</strong> Best for forecasting with sequential patterns</li>
                        <li><strong>GRU:</strong> Faster alternative to LSTM with similar performance</li>
                    </ul>

                    <h3>Pipeline Order</h3>
                    <div class="alert alert-info">
                        <strong>Critical:</strong> Always perform imputation before forecasting. The forecasting models require complete data without missing values.
                    </div>
                    
                    <h3>Training Workflow</h3>
                    <ol>
                        <li>Train imputation model using <code>run_imputation_train_pipeline</code></li>
                        <li>Save the trained imputation model</li>
                        <li>Train forecasting model using <code>run_forecasting_train_pipeline</code></li>
                        <li>Save the trained forecasting model</li>
                        <li>Use both models in <code>run_prediction_pipeline</code> for production predictions</li>
                    </ol>
                </section>

                <section id="troubleshooting">
                    <h2>Troubleshooting</h2>
                    
                    <h3>Common Issues</h3>
                    
                    <h4>Issue: Poor imputation quality</h4>
                    <p><strong>Solution:</strong> Try adjusting model parameters or using more training data</p>
                    <pre><code>config.set('seq_units', 256)
config.set('epochs', 50)</code></pre>

                    <h4>Issue: Forecasts are inaccurate</h4>
                    <p><strong>Solution:</strong> Ensure imputation was successful and try different model architectures</p>
                    <pre><code>config.set('lstm_units', 256)
config.set('lookback', 60)</code></pre>
                    
                    <h4>Issue: Model training is too slow</h4>
                    <p><strong>Solution:</strong> Reduce model complexity or use GPU acceleration</p>
                    <pre><code>config.set('seq_units', 64)
config.set('batch_size', 64)</code></pre>
                </section>

                <section>
                    <h2>Support & Resources</h2>
                    <ul>
                        <li><strong>GitHub Issues:</strong> <a href="https://github.com/isrkan/Competitive_Price_Intelligence/issues" target="_blank">Report bugs and request features</a></li>
                        <li><strong>Documentation:</strong> Comprehensive guides and API references for each package</li>
                        <li><strong>Examples:</strong> Jupyter notebooks with real-world use cases and tutorials</li>
                    </ul>
                </section>
            </div>
        </main>
    </div>
</body>
</html>